var SaleCommJs=window.SaleCommJs||{};SaleCommJs.url_goods_banner="",SaleCommJs.url_goods_detail="",SaleCommJs.url_get_data=function(){var a=window.document.location.href.toString();a=a.replace(/(\#[\w\.]*$)/g,"");var e=a.split("?");if("string"==typeof e[1]){e=e[1].split("&");var i={};for(var t in e){var o=e[t].split("=");i[o[0]]=o[1]}return i}return{}},SaleCommJs.getCookieValue=function(a){var e=document.cookie,i=e.indexOf(""+a+"=");return-1==i&&(i=e.indexOf(a+"=")),-1==i?e=null:(i=e.indexOf("=",i)+1,cookieEndAt=e.indexOf(";",i),-1==cookieEndAt&&(cookieEndAt=e.length),e=unescape(e.substring(i,cookieEndAt))),e},SaleCommJs.shopInfo=function(){$("#detailLoad").hide();var a=this.v_cartCenter,e={id:a.docId,url:a.url,ref:a.ref};a.outside_url&&(e.url=a.outside_url);var i=this.url_goods_detail;$.ajax({url:i,data:e,type:"GET",dataType:"jsonp",success:function(a){"undefined"!=typeof a.val&&$("#shopInfo").append(a.val)},complete:function(){}})},SaleCommJs.showGuigeSku=function(){$("#detailLoad").hide();var a=this.v_cartCenter,e=a.url;a.outside_url&&(e=a.outside_url);var i=ajaxToSkuUrl;$.ajax({url:i,data:{docId:a.docId,url:e},type:"GET",dataType:"jsonp",success:function(e){"undefined"!=typeof e.val&&(window.sku_signal=JSON.stringify(e.val),a.displayGuige(e.val))},complete:function(){}})},SaleCommJs.goodsItemInfo=function(){var a={id:"",url:$("#originUrl").val(),ref:""},e=this.url_goods_detail;$.ajax({url:e,data:a,type:"GET",dataType:"jsonp",success:function(a){"undefined"!=typeof a.val&&$("#show_panel_shopInfo").append(a.val)},complete:function(){}})},SaleCommJs.areaLimitShow=function(a,e){var i="";"undefined"!=typeof e&&(i=e);var t="",o="",n="",s=a.length;if(0>=s)return!1;if(s>20){var r={A:[],B:[],C:[],D:[],E:[],F:[],G:[],H:[],I:[],J:[],K:[],L:[],M:[],N:[],O:[],P:[],Q:[],R:[],S:[],T:[],U:[],V:[],W:[],X:[],Y:[],Z:[]};$.each(a,function(a,e){o=pinyin.getCamelChars(e),n=o.substr(0,1),r[n].push(e)});var l={},c=0,d=0;for(var u in r){var p=[];for(var f in r[u])p.push(r[u][f]);c%6==0&&(++d,l[d-1]={cap:{}}),l[d-1].cap[u]=p,++c}var m={0:{cap:{}},1:{cap:{}},2:{cap:{}},3:{cap:{}},4:{cap:{}},5:{cap:{}}};m[0].cap.A=r.A,m[0].cap.B=r.B,m[0].cap.C=r.C,m[0].cap.D=r.D,m[1].cap.E=r.E,m[1].cap.F=r.F,m[1].cap.G=r.G,m[1].cap.H=r.H,m[2].cap.J=r.J,m[2].cap.K=r.K,m[2].cap.L=r.L,m[2].cap.M=r.M,m[3].cap.N=r.N,m[3].cap.O=r.O,m[3].cap.P=r.P,m[3].cap.Q=r.Q,m[3].cap.R=r.R,m[3].cap.S=r.S,m[4].cap.T=r.T,m[4].cap.U=r.U,m[4].cap.V=r.V,m[4].cap.W=r.W,m[4].cap.X=r.X,m[5].cap.Y=r.Y,m[5].cap.Z=r.Z,l=m;var v="",g="";v+='<ul class="area-tabs '+i+'">';for(var u in l){var h="dis";if(l[u].cap){var C=l[u].cap;for(var _ in C)for(var y in C[_])if("string"==typeof C[_][y]){h="act";break}}if(l[u].cap){v+='<li class="'+h+'">',g+='<div class="area-tab-card" style="display: none;">';var C=l[u].cap;for(var _ in C){var b=!1;for(var y in C[_])if("string"==typeof C[_][y]){b=!0;break}if(v+=_,0!=b){g+='<dl class="area-hct-list '+i+'"><dt>'+_+'</dt><dd><ul class="area-list '+i+'">';for(var y in C[_])"string"==typeof C[_][y]&&(g+='    <li class="area-item">        <span title="'+C[_][y]+'">'+C[_][y]+"</span>    </li>");g+="</ul></dd></dl>"}}v+="</li>",g+="</div>"}}v+="</ul>",t+=v+g,$(".area-box").removeClass("area-box-normal")}else $.each(a,function(a,e){t+='<li class="area-item"><span title="'+e+'">'+e+"</span></li>"}),t='<ul class="'+i+'" id="areaContainer">'+t+"</ul>";return $(".area-box").html(t),$(".area-a").hover(function(){$(".area-box").show(),$(this).addClass("area-a-down")},function(){$(".area-box").hide(),$(this).removeClass("area-a-down")}),$(".area-tabs li").hover(function(){$(this).hasClass("act")&&($(this).addClass("cur").siblings("li").removeClass("cur"),$(".area-tab-card:eq("+$(".area-tabs li").index(this)+")").show().siblings(".area-tab-card").hide())}),$(".area-tabs li.act").each(function(){return $(this).addClass("cur"),$(".area-tab-card:eq("+$(".area-tabs li").index(this)+")").show().siblings(".area-tab-card").hide(),!1}),$(".area-info").show(),t},SaleCommJs.chkUserVIP=function(){var a=this.url_u_rank;$.ajax({url:a,data:{},type:"GET",dataType:"jsonp",success:function(a){var e=0;"undefined"!=typeof a.val&&"yes"==a.val&&(e=1),e?($("#vip-type-yes").show(),$("#vip-type-no").hide()):($("#vip-type-yes").hide(),$("#vip-type-no").show())},complete:function(){}})},SaleCommJs.showGuigeForHan=function(){var b=this.v_cartCenter,sku_val=b.sku_info,sku_val=eval("("+sku_val+")");b.displayGuige(sku_val),$(".gg_prop a.pic").each(function(){$(this).on("click",function(){var a=$(this).find("img").eq(0).attr("src");if(a){var e=$(".details-small-img").find('img[src="'+a+'"]');e.click(),e.parent().parent().addClass("selected")}})})},SaleCommJs.showHanComment=function(){var a=this.url_han_comment;$.ajax({url:a,data:{item_id:$("#tid").val(),page:$("#page_num").val()},type:"GET",dataType:"jsonp",success:function(a){"undefined"!=typeof a.val&&$(".user-vealuation").html(a.val)},complete:function(){SaleCommJs.doSomeComment()}})},SaleCommJs.clickGoFav=function(){$(".go-fav").on({click:function(){return b5m.ui.isULogin.isNoLogin(function(){SaleCommJs.reflashLogin();var a=$(".go-fav").get(0);if(Cookies.get("token")&&"true"===$.trim(Cookies.get("login"))){var e={userId:Cookies.get("token"),goodsUrl:$(a).attr("data-url"),picUrl:$(".details-big-img img").attr("src")?$(".details-big-img img").attr("src"):b.imgPath,title:document.title,webSite:"b5m.com",price:$(".total-product-price").attr("data"),source:"0"};$.getJSON(SaleCommJs.url_api_wiki_url+"/gc/user/favorites/data/add.htm?jsonpCallback=?",e,function(e){if(e){$(".go-fav").css("color","red"),$(".go-fav em").css("background-position","0px -12px");var i=$(a).offset();$(".fav-tip").css({top:i.top+a.offsetHeight,left:i.left-10}).show().fadeOut(3e3)}try{$("#clvd-dialog").hide()}catch(t){}})}else location.href=SaleCommJs.url_api_wiki_url+"/forward.htm?method=/user/user/index";return!1})?!1:void 0}})},SaleCommJs.simpleCheckLogin=function(){var a=SaleCommJs.getCookieValue("login"),e=SaleCommJs.getCookieValue("token");if("true"!=a||""==e){var i=window.js_ucenter_url||"http://ucenter.b5m.com",t=i+"/forward.htm?method=/user/user/login&loginReferer="+encodeURIComponent(window.location.href);return t}return"ok"},SaleCommJs.reflashLogin=function(){$("#login-pop-window").hide();var a="true"===Cookies.get("login")&&Cookies.get("token");a&&$.ajax({url:b5m.host.ucenter+"/user/user/data/info.htm?isSimple=2",dataType:"jsonp",jsonp:"jsonpCallback"}).success(function(a){return a.ok?void $("#topbar").find(".login-icon,.b5m-login,.b5m-reg").hide().end().find(".user-menu").removeClass("hidden").end().find(".user-name span").text(decodeURIComponent(a.data.showName)):(Cookies.set("login","false",new Date,"/",".b5m.com"),!1)})},SaleCommJs.shopHaiwaiAd=function(a){{var e=a.container,i=$('<ul class="grid-view cf"></ul>');$("#docId").val()}i.appendTo(e),$.ajax({url:a.url,data:{title:$("#last_cat").val()},type:"GET",dataType:"jsonp",success:function(a){if("undefined"!=typeof a[0].shopList){var e=a[0].shopList,t=0;$.each(e,function(a,e){if(4>t){var o=e.Url,n=(e.Picture,"");e.OriginalPicture&&(n=e.OriginalPicture.split(",")[0]);var s=e.Source,r=e.Price,l=e.Title,c=$('<li class="grid-mod"></li>');c.append('<a class="pic" target="_blank" href="'+o+'"> <img src="'+n+'" alt=""></a>'),c.append('<div class="grid-item"><a class="des" target="_blank" href="'+o+'">'+l+"</a> </div> "),c.append('<div class="grid-item gird-price"> <span class="goods-origin r">'+s+'</span> <strong class="price"><b>￥</b>'+r+"</strong> </div>  "),c.append('<div class="grid-item grid-go-buy"> <a target="_blank" href="'+o+'" class="go-buy l">去看看</a> </div>'),i.append(c)}++t})}},complete:function(){}})},SaleCommJs.showPidDetail=function(){var a=this.url_pid_detail||"/goods/product-detail";$.ajax({url:a,data:{id:$("#pid").val()},type:"GET",dataType:"jsonp",success:function(a){"undefined"!=typeof a.val&&$("#show_content").html(a.val)},complete:function(){}})},SaleCommJs.showTidDetail=function(){var a=this.url_tid_detail||"/goods/product-detail";$.ajax({url:a,data:{id:$("#tid").val()},type:"GET",dataType:"jsonp",success:function(a){if("undefined"!=typeof a.val&&""!=a.val){$("#show_content").html(a.val);try{$("img[lazy-src]").lazyload({data_attribute:"lazy-src"})}catch(e){}}},complete:function(){}})};